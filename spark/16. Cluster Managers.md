# 16. Cluster Managers ðŸ–§

## YARN (Hadoop Cluster Manager)

```python
spark = SparkSession.builder \
    .master("yarn") \
    .config("spark.deploy.mode", "cluster") \
    .config("spark.yarn.queue", "production") \
    .config("spark.yarn.driver.memoryOverhead", "512m") \
    .config("spark.yarn.executor.memoryOverhead", "1g") \
    .getOrCreate()

# spark.deploy.mode:
# - "cluster": Driver runs on cluster (production)
# - "client": Driver runs on client machine (development)

# yarn.queue: YARN queue (for resource isolation)

# memoryOverhead: Extra memory for JVM overhead
```

### YARN Resource Management

```
YARN Resource Manager
    â†“
Allocates resources to Spark Application Master
    â†“
Spark Application Master
    â†“
Launches Spark Executors on NodeManagers
```

## Kubernetes (K8s)

```python
spark = SparkSession.builder \
    .master("k8s://https://kubernetes-api:443") \
    .config("spark.kubernetes.namespace", "default") \
    .config("spark.kubernetes.driver.pod.name", "spark-driver") \
    .config("spark.executor.instances", "10") \
    .getOrCreate()

# K8s automatically scales executors based on workload
```

## Standalone

```python
spark = SparkSession.builder \
    .master("spark://master-node:7077") \
    .config("spark.deploy.mode", "cluster") \
    .getOrCreate()

# Spark's own cluster manager
# Suitable for small clusters
```
